if(_&&_.clone&&Backbone&&Backbone.Events){var envoy=_.clone(Backbone.Events);envoy._offers={},envoy.offer=function(e,o,n){envoy._offers[e]=envoy._offers[e]||[],envoy._offers[e].push({callback:o,namespace:n||void 0})},envoy.withdraw=function(e,o){if(0>=_.size(envoy._offers[e]))return void 0;var n=!1;if(o=o||void 0,void 0===o)delete envoy._offers[e];else{var r=[];_.each(envoy._offers[e],function(f,t){f.namespace===o?n=!0:r.push(envoy._offers[e][t])}),envoy._offers[e]=r,0>=_.size(envoy._offers[e])&&delete envoy._offers[e]}return n},envoy.solicit=function(e){if(0>=_.size(envoy._offers[e]))return void 0;var o=Array.prototype.slice.call(arguments,1,4),n=_.find(o,function(e){return"boolean"==typeof e}),r=_.find(o,function(e){return"string"==typeof e}),f=_.find(o,function(e){return"function"==typeof e}),t=[];return _.every(envoy._offers[e],function(e){return void 0!==r&&r!==e.namespace||("function"==typeof e.callback?t.push(e.callback()):t.push(e.callback),!n)?!0:(t=t[0],!1)}),f?f(t):t},envoy._storage={},envoy.store=function(e,o){return envoy._storage[e]=o,o},envoy.fetch=function(e,o){return void 0!==envoy._storage[e]?envoy._storage[e]:o},envoy.rouse=function(e,o){var n=envoy._rouseVal(envoy._storage[e]);return void 0!==n?n:o},envoy._rouseVal=function(e){var o,n;return _.isFunction(e)?o=e():(n=_.isArray(e)||_.isObject(e))?(o=n?[]:{},_.each(e,function(e,n){o[n]=envoy._rouseVal(e)})):o=e,o},envoy.erase=function(e){return delete envoy._storage[e],!0};var global_object="undefined"!=typeof window?window:"undefined"!=typeof GLOBAL?GLOBAL:{};global_object.envoy=envoy}